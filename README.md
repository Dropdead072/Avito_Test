# Тестовое задание на стажировку АВИТО

HF Model Link: [mbart-large-50-spaces](https://huggingface.co/Dropdead072/mbart-large-50-spaces)

### Computational Power

CUDA: 12.6

GPU: NVIDIA GeForce RTX 3060 Laptop GPU

## Структура

├── data/

│   └── dataset\_1937770\_3.txt      # тестовый датасет из Stepik

├── mbart-space-fix/               # локальные чекпоинты обученной модели (не загружаются в GitHub)

├── train\_model\_data/

│   └── wiki\_dataset.csv           # собранный датасет (Wiki + синтетика)

├── .gitignore

├── README.md

├── basic\_functions.ipynb          # эксперименты с функциями предобработки

├── data\_collection.py             # функции для формирования датасета `wiki_dataset.csv`

├── model\_test.ipynb               # тестирование обученной модели (загрузка из локальной папки)

├── model\_train.ipynb              # обучение модели для задачи расстановки пробелов

├── processing.py                   # базовые функции обработки (эвристика, индексы пробелов, чтение .txt)

└── scorer.py                      # локальная функция подсчёта F1


## Запуск 

Для запуска инференса кода требуется установить requirements.txt и запустить скрипт `get_answers.py`


## Логика решения

Решение основано на комбинации эвристик и дообученной модели `mbart-large-50`.  

### Эвристики

Эвристики, реализованные в классе `SpaceRestorer`:

1. **Буква -> число**  

   Если после буквы идёт цифра, вставляется пробел: Москва2023 -> Москва 2023

2. **Число -> буква**  

    Если после числа идёт буква, вставляется пробел: 2023год -> 2023 год

3. **Маленькая буква -> заглавная буква** 

    Если после строчной буквы идёт заглавная, добавляется пробел: iphoneX -> iphone X

4. **Смена языка (кириллица <-> латиница)** 

    Если символ кириллицы стоит рядом с латинским — между ними вставляется пробел: телефонSamsung -> телефон Samsung

5. **Запятые**  

    Нормализуется пробел после запятой (убираются лишние или добавляется если отсутствует): Москва,2023 -> Москва, 2023

6. **Частотные слова (лексика объявлений)**  

    Если после распространённых слов («куплю», «продам», «новый», «доставка» и др.) сразу идёт буква, вставляется пробел: продамквартиру -> продам квартиру

7. **Бренды и названия**  

    Аналогично для часто встречающихся брендов («iPhone», «Samsung», «LG», «IKEA», «Xiaomi» и др.): телефонSamsung -> телефон Samsung

### Модель

За основу была взята модель `mbart-large-50` и дообучена на кастомном датасете, созданном на основе модифицированных корпусов с википедии + синтетических данных, схожих с данными из датасета